Skypebot-todo
================

シンプルなタスク管理用のSkypeボット。

チームでSkypeのチャットを日常的に使って連絡を取り合っている場合に、ついでにチームのタスクもSkype上で管理するためのもの。チャットに決められた書式で発言することでタスクが追加され、毎日決まった時間にタスクの内容が自動投稿される。

Windows上で動作する(Windows Scripting Host)。

追加されたタスクは、単純なテキストファイルとして作成される。このスクリプトでは、タスクの内容を修正したり、完了したものを削除したりする機能を提供しない。タスクの修正や削除は、メモ帳などのテキストエディタでファイルを直接編集することを想定している。なのでチームで共有しているDropboxのフォルダなどをファイル置き場にすると良い。

必要なもの
----------------

* Skypeインストール済みで常時起動しているWindowsパソコン
* Skypeアカウント
* [Skype4COM](https://developer.skype.com/accessories/skype4com)
* Dropboxアカウント(なくてもよいがあった方が便利)

Skype4COMのインストール
----------------

* Skype4COM.chm
* Skype4COM.dll

を適当なフォルダに置いて、コマンドプロンプトから

    regsvr32 Skype4COM.dll

とする。

設定
----------------

ファイル **skypebot-todo.js** の冒頭で設定を行う。

* **todo_path** は、タスクファイルを保存する場所。チームで共有しているDropbox上のフォルダを指定する。
* **todo_file** は、保存されるファイル名。実際にはSkypeチャット名が先頭に追加される。
* **todo_regex** は、タスク追加を表す発言の書式。この書式にマッチする発言がタスク追加とみなされる。
* **post_times** は、タスクを自動投稿する時刻。

起動方法
----------------

1. Skypeを起動してログインする。
1. 普段使ってるSkypeチャットにこのアカウントを参加させる。
1. コマンドプロンプト(32bit版)を起動。
    * 32bit版のWindowsなら **C:\\Windows\\system32\\cmd.exe**
    * 64bit版のWindowsなら **C:\\Windows\\SysWOW64\\cmd.exe**
1. `cscript.exe skypebot-todo.js`

初回はSkypeから確認のダイアログが出るので許可を出す。

これで常駐状態になる。

使い方
----------------

チャットに対して、「todo」「とど」「トド」のいずれかと、それに続いて半角コロン(:)、半角スペース、全角スペース、読点(。)の文字で始まってる発言をする。タスクの詳細情報も登録するなら、同じ発言内で改行して2行目以降に記述する。

    todo: ○○を△△する

または、

    とど。○○を△△する
    ××の□□が☆☆なので、＊＊を行う。

のような感じ。すると自動的に「OK.」と返り、内容がファイルに保存される。

そして設定された時刻になると、ファイルの内容が自動投稿される。すべて投稿されるのではなく、各タスクの先頭の行だけが投稿される。2行目以降に記述した詳細情報は、ファイルを直接見れば書いてある。

タスクの修正や削除をしたいときは、ファイルを直接編集する。

メモ
----------------

* 終了するときはCtrl + C。
* 「とど」や「トド」も書式としてサポートしているのは、iPhoneなどから入力するときに手間をかけさせないため。
